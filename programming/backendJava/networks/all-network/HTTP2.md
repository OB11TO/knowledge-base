---
title: HTTP2
tags:
  - Network
related_topics: 
created: 2024-09-12 18:19
modified: 2024-09-13T17:39:37+03:00
questions: 
notes: 
links: 
---


### HTTP/2

Главные отличия от HTTP/1.1 :

- ==Бинарный вместо текстового==  
      
    ==Бинарные сообщения быстрее разбираются автоматически, представляя из себя== ==фреймы и потоки.== ==Но в отличие от текстовых, не понятны для чтения человеком.==  
    Переходом на<mark class="hltr-red"> бинарный формат</mark>, HTTP/2 <mark class="hltr-green2">пытается решить проблему выросшей задержки</mark> (latency)  
    
    ![[Untitled 30.png]]
    

Теперь все  
====HTTP== ==сообщения делятся на фреймы== ==(HEADERS, DATA, RST_STREAM, PUSH_PROMISE, PRIORITY,etc)==

![[Untitled 31.png]]

==Коллекция таких фреймов== - ==двунаправленные поток== (`Stream`). Следовательно, ==каждый фрейм содержит идентификатор== ==(id)== ==потока  
Каждый  
====клиентский ==запрос использует== ==нечетные== ==id====, а ответ от ==сервера== четные

![[Untitled 32.png]]

- ==Мультиплексирование== (==несколько асинхронных запросов через одно TCP- соединение== )  
    Благодаря  
    ==бинарному протоколу и представлению данных в виде фреймов и потоков, клиент и сервер могут обмениваться сообщениями асинхронно, используя лишь одно TCP соединение.==  
    Это также  
    ==решило проблему блокировки очереди запросов, когда медленный или большой запрос блокировал все последующие.==
- ==Server Push== (несколько ответов на один запрос)
    
    Сервер, зная, что клиент собирается запросить определенный ресурс, может отправить его сам, не дожидаясь запроса  
    Для этого сервер отправляет специальный фрейм PUSH_PROMISE с таким же id, что и запрос клиента  
    
    ![[Untitled 33.png]]
    
    ![[Untitled 34.png]]
    
- ==Сжатие заголовков методом HPACK==  
    Формат сжатия HTTP/2 заголовков HPACK состоит из трез основныз частей:  
    - Статическая таблица - общая для всех TCP соединений и содержит 61 часто используемые заголовки, которые можно найти в документации протокола
    - Динамическая таблица - создается для каждого TCP соединения и содержит используемые заголовки во время обмена сообщениями (ограниченного размера)
        
        ![[Untitled 35.png]]
        
        ![[Untitled 36.png]]
        
    - Сжатие заголовков алгоритмом Хаффмана
- ==Приоритизация запросов==  
    Клиент может назначить приоритет потоку (stream), добавив соответствующую информацию во фрейме HEADERS (число от 1 до 256), либо обновить уже созданный поток с помощью фрейма PRIORITY  
    Также каждому потоку может быть дана явная зависимость от другого потока, что вместе с приоритетами (пункт 1) представляет собой “дерево приоритетов”  
    
    ![[Untitled 37.png]]
    
- ==Безопасность==  
    Большинство клиентов (браузеров) поддерживают HTTP/2 только если он используется поверх протокола TLS ( т.е. должен использоваться протокол HTTPS)  
    В своб очередь, спецификация не требует данного ограничения  
    Сокращение числа подключений ввиду перечисленныз преимуществ HTTP/2 приводит к сокращению затратных “рукопожатий TLS” (TLS handshake)  
    
