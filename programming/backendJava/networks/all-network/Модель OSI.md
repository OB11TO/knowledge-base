---
title: Модель OSI
tags:
  - Network
related_topics: 
created: 2024-09-12 17:54
modified: 2024-09-13T16:53:28+03:00
questions: 
notes: 
links: 
---

---
##### Уровни OSI
[[Прикладной уровень]]
[[Уровень представления]]
[[Сеансовый уровень]]
[[Транспортный уровень]]
[[Сетевой уровень]]
[[Канальный уровень]]
[[Физический уровень]]

----

![[images/Untitled 17.png|Untitled 17.png]]

<mark class="hltr-red">Open System Interconnection model</mark> - эталонная модель <mark class="hltr-green2">взаимодействия открытых систем, которая лежит в основе всех стандартов компьютерных сетей.</mark>

![[images/Untitled 1 6.png|Untitled 1 6.png]]


>[!faq] Клиент делает запрос на сервер например Post расскажи про каждый уровень OSI про каждый протокл про DNS про все тонкости и нюансы и тд Объясни это всё подробно и попорядку

Когда клиент делает запрос на сервер (например, HTTP POST-запрос), данные проходят через несколько уровней сетевой модели OSI и TCP/IP. Давайте рассмотрим процесс постадийно, шаг за шагом, с объяснением работы каждого уровня, протоколов, механизма DNS и других нюансов.

### Шаг 1: Приложение (Уровень 7 - Приложения)

1. **Подготовка данных на клиенте:**
    
    - На уровне приложения клиентское приложение (например, веб-браузер или мобильное приложение) создает HTTP POST-запрос. Например, запрос отправки данных формы на сайт.
    - HTTP работает на уровне приложения и включает в себя заголовки, метод (в данном случае POST), тело запроса (например, данные формы) и URL назначения.
2. **DNS-запрос (Если необходимо):**
    
    - Если в запросе используется доменное имя (например, `example.com`), необходимо преобразовать его в IP-адрес.
    - Протокол DNS (Domain Name System) отвечает за это преобразование. Клиент отправляет запрос к DNS-серверу, который ищет соответствие доменного имени и IP-адреса.
    - Этот процесс может включать обращение к кэшу операционной системы или локального DNS-сервера, если адрес уже разрешен, иначе DNS-запрос отправляется на серверы в Интернете.
    
    **Пример запроса:**
    
    `POST /login HTTP/1.1 Host: example.com Content-Type: application/json Content-Length: 27`
    
    **Пример DNS-запроса:**
    
    `example.com -> DNS -> 93.184.216.34`
    

### Шаг 2: Представление и Сеансовый уровень (Уровни 6 и 5)

На этих уровнях происходит:

- **Представление данных**: Здесь может происходить преобразование данных (например, шифрование через SSL/TLS).
    - В случае защищенного HTTPS соединения (которое работает через SSL/TLS), шифрование данных начинается на уровне приложения перед передачей их вниз по сетевому стэку. TLS (Transport Layer Security) шифрует данные, чтобы они были защищены от перехвата.
- **Сеансовый уровень**: Устанавливается сессия (например, сессия TLS) между клиентом и сервером.

**Пример с использованием HTTPS:**

- Клиент и сервер обмениваются криптографическими ключами (через механизм TLS Handshake), после чего весь последующий трафик между ними шифруется.

### Шаг 3: Транспортный уровень (Уровень 4 - Транспорт)

1. **Установление TCP-соединения:**
    
    - На транспортном уровне используется протокол TCP (Transmission Control Protocol) для установления надежного соединения. TCP гарантирует доставку данных в правильном порядке и без потерь.
    - Чтобы установить соединение, используется **трехстороннее рукопожатие (Three-Way Handshake)**:
        - Клиент отправляет серверу сегмент с флагом SYN.
        - Сервер отвечает сегментом с флагом SYN-ACK.
        - Клиент подтверждает получение, отправляя сегмент с флагом ACK.
    - После этого установлено TCP-соединение, через которое передаются данные.
    
    **Пример рукопожатия TCP:**
    
    
    `Клиент -> Сервер: SYN Сервер -> Клиент: SYN-ACK Клиент -> Сервер: ACK`
    
2. **Нумерация и сегментация данных:**
    
    - TCP разбивает данные на сегменты (части) и назначает каждому сегменту номер. Это гарантирует, что данные будут собраны в правильном порядке на сервере.

### Шаг 4: Сетевой уровень (Уровень 3 - Сеть)

1. **IP-адресация и маршрутизация:**
    
    - На сетевом уровне данные инкапсулируются в пакеты, и к ним добавляется заголовок IP. В заголовке IP указывается **IP-адрес назначения (сервера)** и **IP-адрес источника (клиента)**.
    - Здесь участвует протокол **IP (Internet Protocol)**, который обеспечивает доставку пакетов через маршрутизаторы к конечному серверу.
    - Если данные идут через Интернет, маршрутизаторы на этом уровне определяют наилучший маршрут (с помощью протоколов маршрутизации, таких как BGP, OSPF).
2. **Фрагментация пакетов:**
    
    - Если данные слишком велики для отправки за один раз, IP может разбить их на несколько пакетов (фрагментация). Каждый пакет имеет идентификационный номер, чтобы сервер мог собрать их обратно.

**Пример заголовка IP:**


`Источник: 192.168.1.2 Назначение: 93.184.216.34`

### Шаг 5: Канальный уровень (Уровень 2 - Канал передачи данных)

1. **MAC-адресация и кадрирование:**
    
    - На канальном уровне (уровне Ethernet или Wi-Fi) данные инкапсулируются в кадры. К кадрам добавляются **MAC-адреса** — это уникальные аппаратные адреса сетевых интерфейсов, которые используются для передачи данных внутри локальной сети (LAN).
    - На этом уровне используются такие протоколы, как **Ethernet**, и данные передаются от одного сетевого устройства к другому через коммутаторы.
2. **Протоколы на этом уровне:**
    
    - Протоколы Ethernet, Wi-Fi (802.11) обеспечивают передачу данных в пределах одной физической сети.
    - Если данные отправляются через беспроводную сеть, на этом этапе происходит передача по Wi-Fi.

**Пример кадра Ethernet:**


`MAC-адрес источника: 00:0a:95:9d:68:16 MAC-адрес назначения: 00:0c:29:58:42:7a`

### Шаг 6: Физический уровень (Уровень 1 - Физический)

1. **Передача сигналов по физической среде:**
    - На физическом уровне данные передаются в виде электрических сигналов по кабелю (Ethernet) или радиоволн (Wi-Fi).
    - Здесь происходит фактическая передача битов (0 и 1) через сетевые устройства, такие как коммутаторы, маршрутизаторы и сетевые карты.

### Шаг 7: Прием на стороне сервера

1. **Получение данных сервером:**
    
    - Пакеты, отправленные клиентом, проходят через маршрутизаторы и другие сетевые устройства, которые обеспечивают их доставку на сервер.
    - Сервер принимает пакеты на физическом уровне, раскладывает их по кадрам, передает на канальный уровень для обработки MAC-адресов, после чего происходит обработка IP-адресов на сетевом уровне.
2. **TCP-пакеты собираются:**
    
    - На транспортном уровне сервер собирает сегменты TCP, проверяя их целостность с помощью контрольных сумм.
    - После успешной сборки данных на транспортном уровне, они передаются на уровень приложения.
3. **Декодирование данных и отправка ответа:**
    
    - Если это запрос HTTPS, данные декодируются (если шифрование TLS было установлено).
    - Затем сервер (например, веб-сервер) обрабатывает запрос и отправляет обратно HTTP-ответ через те же уровни ОСИ, но уже в обратном порядке.

### Важно: Когда устанавливается порт?

Порты относятся к транспортному уровню (уровень 4):

- Клиент использует **случайный временный порт** для отправки запроса (например, 49152–65535).
- Сервер использует **определенный порт** для приема запроса (например, порт 80 для HTTP или 443 для HTTPS).

Когда TCP-соединение устанавливается, порт клиента и сервера определяется в процессе рукопожатия TCP.

### Заключение

Этот процесс охватывает весь путь передачи данных от момента создания HTTP-запроса до его отправки через сеть и обработки сервером. Это взаимодействие основано на работе различных уровней модели OSI, а также ключевых протоколов, таких как TCP, IP и DNS.