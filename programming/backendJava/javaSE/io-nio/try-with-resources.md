---
title: try-with-resources
tags:
  - IO-NIO
related_topics: 
created: 2024-09-10 17:41
modified: 2024-09-10T17:48:06+03:00
questions: 
notes: 
links: 
---
### try-with-resources

Try-with-resources - это специальная конструкция в Java, которая <mark class="hltr-yellow">позволяет автоматически закрывать ресурсы</mark> (например, <mark class="hltr-green2">файлы, потоки ввода-вывода и т.д</mark>.), после того как они были использованы.

```Java
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    String line;
    while ((line = br.readLine()) != null) {
        System.out.println(line);
    }
} catch (IOException e) {
    System.err.println("Ошибка чтения файла: " + e.getMessage());
}
```
Чтобы ресурс автоматически закрывался в блоке **`try-with-resources`** в Java, необходимо, чтобы этот ресурс **реализовывал интерфейс `AutoCloseable`** (или его расширение — интерфейс `Closeable`).

### Условия для автоматического закрытия ресурса:

1. **Реализация интерфейса `AutoCloseable`**:
    
    - Класс, который представляет ресурс (например, файл, поток данных или соединение), должен реализовать интерфейс `AutoCloseable`. Этот интерфейс содержит метод `close()`, который будет вызван автоматически по завершении работы блока `try`.
    - Большинство классов ввода-вывода в Java, такие как `FileInputStream`, `BufferedReader`, `FileWriter` и другие, уже реализуют либо `AutoCloseable`, либо его наследник `Closeable`.
2. **Использование конструкции `try-with-resources`**:
    
    - Для автоматического закрытия ресурса вы используете конструкцию `try-with-resources`, которая была введена в Java 7. В этой конструкции ресурс объявляется в круглых скобках сразу после `try`.
    - Когда выполнение блока `try` завершится (либо успешно, либо из-за исключения), метод `close()` будет вызван автоматически для всех ресурсов, объявленных в этом блоке.


Конструкция try-with-resources гарантирует, что файл будет закрыт после того, как мы закончим чтение данных. Для этого мы объявляем `BufferedReader` в скобках после ключевого слова try.

Таким образом, даже если произойдет исключение в блоке try, файл будет автоматически закрыт, и мы не будем его удерживать открытым.

Обратите внимание, что класс `BufferedReader` <mark class="hltr-yellow">реализует интерфей</mark>с `AutoCloseable`, ч<mark class="hltr-green2">то позволяет автоматически закрывать ресурсы при использовании try-with-resources.</mark>

Такой подход упрощает работу с ресурсами и позволяет избежать утечки ресурсов, что может привести к проблемам с производительностью или даже к аварийному завершению программы.