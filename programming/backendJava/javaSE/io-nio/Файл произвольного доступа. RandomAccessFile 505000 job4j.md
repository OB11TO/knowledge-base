---
title: Файл произвольного доступа. RandomAccessFile 505000 job4j
tags:
  - IO-NIO
  - Job4j
related_topics: 
created: 2025-01-21 17:24
modified: 2025-03-26T11:41:03+03:00
questions: 
notes: 
links: 
---


В этом уроке мы поговорим про класс RandomAcce sFile.

Ранее мы познакомились с классами работы с файлами FileInputStream и FileOutputStream. С помощью этих классов мы можем либо только читать из файла, либо только записывать в файл, так как эти потоки являются последовательными, то есть в этих потоках доступ к данным происходит последовательно от байта к байту (либо от символа к символу в случае FileReader / FileWriter).

Файл, который читается с помощью последовательного потока, называется файлом с последовательным доступом. Данные такого файла нельзя обновлять, пока идёт чтение или запись. В Java есть возможность читать и записывать в файл одновременно. Для этого существует класс RandomAccessFile в пакете java.io. Класс RandomAccessFile даёт возможность читать и записывать данные в любом месте файла. Таким образом можно обращаться к данным в произвольном порядке. Файл, читаемый с помощью класса RandomAccessFile называется файлом с произвольным доступом. Данные можно читать и записывать из / в любого места файла.


В отличие от других классов-потоков, которые рассматриваются в этом разделе, класс RandomAccessFile не наследуется от классов InputStream и OutputStream. Вместо них он реализует интерфейсы DataInput и DataOutput, а также имеет свои методы для осуществления одновременного чтения и записи файла. 


Файл произвольного доступа - это **последовательность байтов**. Он поддерживает файловый указатель - это указатель местоположения курсора в файле (его позиция). При создании файла произвольного доступа этот указатель всегда находится на нулевой позиции. При чтении / записи одного байта указатель двигается вперёд к следующему байту данных. 

Например, так выглядит состояние при начале работы. Указатель стоит в нулевой позиции:

![[Pasted image 20250121173536.png]]

Главная особенность класса RandomAccessFile - это возможность перемещаться по данным и читать только те данные, которые нам нужны, вместо считывания файла целиком, а также записывать данные в указанное место (в начало, конец или произвольно). 

Для этого в классе RandomAccessFile определены следующие методы:

- seek(номер позиции) - перемещает указатель на указанную позицию (выставляет указатель перед указанной позицией, как на картинках выше). Соответственно seek(0) переместит указатель в начало файла, а seek(файл.length()) переместит указатель в конец файла.

- getFilePointer() - возвращает текущую позицию, на которой находится указатель в данный момент. Как было указано выше, файл произвольного доступа - это последовательность байтов, поэтому этот и предыдущий методы устанавливают и возвращают позицию именно в байтах. То есть если у нас, например, в файле записано несколько значений типа int, то чтобы прочитать второе значение, нужно ставить указатель на 4 позицию, так как первые 4 байта (0-3 ячейки) будет занимать первое значение типа int.

![[Pasted image 20250121173552.png]]

```java
RandomAccessFile randomAccess = new RandomAccessFile("data/random.txt", "r");

```

Режимы бывают трех типов: "r" - файл будет открыт только для чтения, "rw" - чтение и запись, "rws" - чтение и запись, при этом каждое изменение файла мгновенно отражается в исходном файле (то есть изменения сразу же сохраняются на носителе). Если указанного файла не существует, то в режиме "r" будет выброшено исключение FileNotFoundException, а в режиме "rw" и "rws" будет создан новый файл с указанным названием.

Далее рассмотрим практический пример применения данного класса. Создайте класс RandomAccess в пакете ru.job4j.io:

```java
package ru.job4j.io;

import java.io.IOException;
import java.io.RandomAccessFile;

public class RandomAccess {

    public static void main(String[] args)  {
        try {
            RandomAccessFile randomAccess = new RandomAccessFile("data/random.txt", "rw");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

}

```


![[Pasted image 20250121173627.png]]

![[Pasted image 20250121173639.png]]
![[Pasted image 20250121173651.png]]

![[Pasted image 20250121173700.png]]

**Документация:**

[RandomAccessFile](https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/io/RandomAccessFile.html)