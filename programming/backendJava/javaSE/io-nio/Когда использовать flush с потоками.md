---
title: Когда использовать flush с потоками
tags:
  - IO-NIO
related_topics: 
created: 2024-09-10 17:27
modified: 2025-03-25T13:40:09+03:00
questions: 
notes: 
links: 
---

### Когда нужно вызывать `flush()`?

1. **После завершения записи данных**:
    
    - Если вы не вызываете `flush()`, данные могут остаться в буфере и **не будут записаны** в конечный выходной поток до закрытия потока.
    - Если вы <mark class="hltr-yellow">закрываете поток с помощью метода</mark> `close()`, этот <mark class="hltr-yellow">метод автоматически вызывает</mark> `flush()`. Поэтому, в большинстве случаев, после завершения работы с потоком и вызова `close()`, **явный вызов `flush()` не требуется**.
    - Однако, если вы не закрываете поток после записи данных (например, для дальнейшей работы), необходимо вручную вызвать `flush()` для сброса данных из буфера.
2. **Если необходимо немедленно записать данные**:
    
    - В некоторых ситуациях важно,<mark class="hltr-yellow"> чтобы данные были записаны немедленно</mark> (например, при записи логов, отправке сообщений по сети и т.д.). В этом случае вы должны вручную вызвать `flush()` для сброса данных из буфера в реальный поток.

3. **При работе с сетевыми соединениями**:
    
    - Когда вы <mark class="hltr-yellow">отправляете данные через сетевое соединение, особенно при использовании буферизованных потоков, важно периодически сбрасывать буфер, чтобы отправить накопленные данные.</mark>
    - Например, если вы п<mark class="hltr-green2">ередаете данные по сокетам, а данные находятся в буфере, они не будут отправлены получателю, пока не будет вызван</mark> `flush()`.

### Что произойдет, если не вызывать `flush()`?

- Если не вызвать `flush()` и просто оставить данные в буфере, они могут **не быть записаны** в выходной поток (например, на диск или в сеть) до тех пор, пока:
    - Буфер не заполнится (и данные будут сброшены автоматически).
    - Поток не будет закрыт (так как `close()` вызывает `flush()` автоматически).
- Это может привести к <mark class="hltr-red">**потере данных**</mark>, <mark class="hltr-yellow">если программа завершится до сброса буфера</mark> или если вы хотите немедленно увидеть результат записи (например, вывод логов на экран).
### Когда `flush()` не требуется:

- Если вы закрываете поток с помощью метода `close()`, это **автоматически** вызовет `flush()` для записи всех данных из буфера.
- Если вы работаете с потоками чтения (`BufferedInputStream`, `BufferedReader`), метод `flush()` не нужен, так как чтение данных из буфера не требует их сброса куда-либо.

### Итог:

- **Да, вызов `flush()` обязателен** в случаях, когда вам нужно гарантированно записать данные из буфера в поток, особенно если поток не будет немедленно закрыт.
- В большинстве случаев, когда вы закрываете поток (с помощью `close()`), **вручную вызывать `flush()` не нужно**, так как это произойдет автоматически.